// Generated by CoffeeScript 1.6.3
(function () {
    var ac;
    ac = angular.module('ac-address-complete', []);

    ac.directive('acAddressComplete', function () {
        return {
            restrict: 'A',
            scope: {
                models: '=acModels',
                options: '=acOptions',
                acSelectedCountry: '=acSelectedCountry',
                onPopulate: '&acOnPopulate'
            },
            link: function (scope, element, attrs) {
                setTimeout(function () {
                    var control, elementId;
                    elementId = attrs.id;

                    control = new pca.Address([
                        {
                            element: elementId,
                            mode: pca.fieldMode.DEFAULT
                        }

                    ], scope.options);
                    control.setCountry(scope.acSelectedCountry);
                    //console.log(control);
                    control.listen("populate", function (address) {
                        var model, toApply, _i, _len, _ref;
                        toApply = "";
                        _ref = scope.models;
                        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                            model = _ref[_i];
                            toApply += "" + model.model + " = '" + address[model.acField] + "';\n";
                        }
                        scope.$parent.$apply(toApply);
                        return typeof scope.onPopulate === "function" ? scope.onPopulate({
                            address: address
                        }) : void 0;
                    });
                    return control;
                }, 100);
            }
        };
    });

}).call(this);
